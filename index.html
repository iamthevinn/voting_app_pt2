<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Voting App Pt1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="node_modules/react/umd/react.development.js"></script>
  <script src="node_modules/react-dom/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>

<body>
    <div id='anchor'></div>
<script type="text/babel">

    class App extends React.Component {
      constructor(props) {
        super(props);
          this.state = {
     
            //votingBoxes: [],
            votingData: []
          }
        //this.updatedVotingBoxList = [];
        this.inputValue = "",
        this.addVotingData = this.addVotingData.bind(this);
        this.captureInput = this.captureInput.bind(this);
        this.sortAndRenderValues = this.sortAndRenderValues.bind(this);
        this.incrementCount = this.incrementCount.bind(this);
         
      }

      addVotingData() {
        let updatedVotingData = this.state.votingData;
        updatedVotingData.push({language: this.inputValue, voteCount: 0})
        console.log("inaddvotingdata")
        console.log(updatedVotingData)
        this.setState({votingData: updatedVotingData})
        //this.updatedVotingBoxList.push(<VotingBox key={this.state.votingData.length-1} id={this.state.votingData.length-1} incrementCount={this.incrementCount } data={this.state.votingData[this.state.votingData.length-1]}/>)
        //this.sortAndRenderValues(this.updatedVotingBoxList);
        }

    
    captureInput (e) {
        this.inputValue = e.target.value;
    }

    sortAndRenderValues(updatedVotingBoxList) {
        console.log("sort")
        let sortedData = this.state.votingData;
        sortedData.sort(function(a, b){ return b.voteCount - a.voteCount })
        this.setState({votingData: sortedData})
    }

    incrementCount(id) {
      console.log("increment");
      console.log(id)
      let updatedVotingData = this.state.votingData;
      updatedVotingData[id].voteCount++
      console.log(updatedVotingData)
      //sortAndRenderValues(this.updatedVotingBoxList)
      this.setState({votingData: updatedVotingData})
    }

      render() {
        let updatedVotingBoxList = []
        console.log("In Render Begin")
        console.log(this.state.votingData)
        for (let i = 0; i < this.state.votingData.length; i++) {
          updatedVotingBoxList.push(<VotingBox key={i} id={i} incrementCount={this.incrementCount } data={this.state.votingData[i]}/>)
        }
        return (
          <div>
            <div>
                <label htmlFor="languageName">Enter a Language: </label>
                <input type="text" id="languageName" name="name" onBlur={this.captureInput}></input>
                <button onClick={this.addVotingData}>Submit</button>
            </div>
            <br />
            <div>
              {updatedVotingBoxList}
            </div>
          </div>
        )
      }
    }



    class VotingBox extends React.Component {
      constructor(props) {
        super(props);
      }
 
      render() {

        const headerStyle = {
            display: 'flex',
            justifyContent: 'center',
            alignItems: 'center',
            fontFamily: 'sans-serif',
            fontSize: '48px'
          }
      
          const votingRectangleStyle = {
            display: 'flex',
            justifyContent: 'center',
            alignItems: 'center',
            fontFamily: 'sans-serif',
            fontSize: '30px',
            width: '300px',
            height: '80px',
            margin: '0 auto',
            border: '3px solid black',
            marginTop: '-3px'
          }
      
          const votingCountStyle = {
            width: '33%',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center'
          }
      
          const libraryNameStyle = {
              width: '33%',
              textAlign: 'center'
            }
          
          const plusSignContainerStyle = {
              width: '33%',
              display: 'flex',
              justifyContent: 'center',
              alignItems: 'center'
              
          }
      
          const plusSign = {
              textAlign: 'center',
              fontWeight: 'bold',
              fontSize: '48px',
              color: 'green',
              display: 'inline',
              cursor: 'pointer'
            }
      
          const circleOutline = {
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                position: 'relative',
                width  : '50px',
                height : '50px',
                borderRadius: '50%',
                fontFamily: 'sans-serif',
                fontSize: '30px',
                border: '1px solid black'
            }
          
        return (
            <div style={votingRectangleStyle}>
              <div style={votingCountStyle}>
                <div style={circleOutline}>{this.props.data.voteCount}</div>
              </div>
              <div style={libraryNameStyle}>{this.props.data.language}</div>
              <div style={plusSignContainerStyle}>
                <div style={plusSign} onClick={ () => {this.props.incrementCount(this.props.id)}} >+</div>
              </div>
            </div>
          )
      }

    }

    ReactDOM.render(<App />,document.getElementById('anchor'))
  </script>
</body>

</html>